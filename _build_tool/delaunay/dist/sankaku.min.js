/*
 inazumatv.com
 @author (at)taikiken / http://inazumatv.com
 @date 2014/06/20 - 11:55

 Copyright (c) 2011-2014 inazumatv.com, inc.

 Distributed under the terms of the MIT license.
 http://www.opensource.org/licenses/mit-license.html

 This notice shall be included in all copies or substantial portions of the Software.

 delaunay
 original: https://github.com/ironwallaby/delaunay

 hosted on
 https://github.com/taikiken/sankaku.js
*/
var Sankaku={version:"0.1.0"};
(function(h){h.console||(h.console={info:function(){},log:function(){},debug:function(){},warn:function(){},error:function(){},table:function(){}});Date.now||(Date.now=function(){return(new Date).getTime()});(function(){for(var g=0,e=["ms","moz","webkit","o"],f=0;f<e.length&&!h.requestAnimationFrame;++f)h.requestAnimationFrame=h[e[f]+"RequestAnimationFrame"],h.cancelAnimationFrame=h[e[f]+"CancelAnimationFrame"]||h[e[f]+"CancelRequestAnimationFrame"];void 0===h.requestAnimationFrame&&void 0!==h.setTimeout&&
(h.requestAnimationFrame=function(d){var c=Date.now(),b=Math.max(0,16-(c-g)),a=h.setTimeout(function(){d(c+b)},b);g=c+b;return a});void 0===h.cancelAnimationFrame&&void 0!==h.clearTimeout&&(h.cancelAnimationFrame=function(d){h.clearTimeout(d)});Object.create||(Object.create=function(){function d(){}return function(c){if(1!==arguments.length)throw Error("Object.create implementation only accepts one parameter.");d.prototype=c;return new d}}());Array.isArray||(Array.isArray=function(d){return"[object Array]"===
Object.prototype.toString.call(d)});Array.prototype.indexOf||(Array.prototype.indexOf=function(d,c){var b;b=c?c:0;var a;if(!this)throw new TypeError;a=this.length;if(0===a||b>=a)return-1;for(0>b&&(b=a-Math.abs(b));b<a;b++)if(this[b]===d)return b;return-1});Array.prototype.forEach||(Array.prototype.forEach=function(d,c){var b,a;b=0;for(a=this.length;b<a;++b)b in this&&d.call(c,this[b],b,this)});Function.prototype.bind||(Function.prototype.bind=function(d){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");
var c=Array.prototype.slice.call(arguments,1),b=this,a=function(){},l=function(){return b.apply(this instanceof a&&d?this:d,c.concat(Array.prototype.slice.call(arguments)))};a.prototype=this.prototype;l.prototype=new a;return l});String.prototype.trim=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")};navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;window.URL=window.URL||window.webkitURL||window.mozURL||
window.msURL})()})(window.self);(function(h){h.Sankaku.extend=function(g,e){e.prototype=Object.create(g.prototype);e.prototype.constructor=e}})(window);
(function(h){h.EventDispatcher=function(){function g(){}var e=g.prototype;e.constructor=h.EventDispatcher;e.addEventListener=function(f,d){"undefined"===typeof this._listeners&&(this._listeners={});var c=this._listeners;"undefined"===typeof c[f]&&(c[f]=[]);-1===c[f].indexOf(d)&&c[f].push(d)};e.hasEventListener=function(f,d){var c=this._listeners;return"undefined"!==typeof c&&"undefined"!==typeof d[f]&&-1!==c[f].indexOf(d)?!0:!1};e.removeEventListener=function(f,d){if("undefined"!==typeof this._listeners){var c=
this._listeners[f],b;"undefined"!==typeof c&&(b=c.indexOf(d),-1!==b&&c.splice(b,1))}};e.dispatchEvent=function(f){var d=this._listeners,c,b;if("undefined"!==typeof d&&"undefined"!==typeof f.type&&(d=d[f.type],"undefined"!==typeof d))for(f.target=this,c=0,b=d.length;c<b;c++)d[c].call(this,f)};g.initialize=function(f){f.addEventListener=e.addEventListener;f.hasEventListener=e.hasEventListener;f.removeEventListener=e.removeEventListener;f.dispatchEvent=e.dispatchEvent};return g}()})(window.Sankaku);
(function(h){h.Sankaku.Iro=function(){function g(){throw Error("Iro can't create instance");}g.rgb2hsl=function(e,f,d){e/=255;f/=255;d/=255;var c=Math.max(e,f,d),b=Math.min(e,f,d),a,l,r;l=(c+b)/2;if(c===b)a=b=0;else{r=c-b;b=0.5<l?r/(2-c-b):r/(c+b);switch(c){case e:a=(f-d)/r+(f<d?6:0);break;case f:a=(d-e)/r+2;break;case d:a=(e-f)/r+4}a/=6}return{h:a,s:b,l:l}};g.hsl2rgb=function(e,f,d){function c(a,b,c){0>c&&(c+=1);1<c&&(c-=1);return c<1/6?a+6*(b-a)*c:0.5>c?b:c<2/3?a+(b-a)*(2/3-c)*6:a}if(0===f)d=f=
e=d;else{var b=0.5>d?d*(1+f):d+f-d*f,a=2*d-b;d=c(a,b,e+1/3);f=c(a,b,e);e=c(a,b,e-1/3)}return{r:255*d,g:255*f,b:255*e}};g.rgb2hsv=function(e,f,d){e/=255;f/=255;d/=255;var c=Math.max(e,f,d),b=Math.min(e,f,d),a,l=c-b;if(c===b)a=0;else{switch(c){case e:a=(f-d)/l+(f<d?6:0);break;case f:a=(d-e)/l+2;break;case d:a=(e-f)/l+4}a/=6}return{h:a,s:0===c?0:l/c,v:c}};g.hsv2rgb=function(e,f,d){var c,b,a,l=Math.floor(6*e),r=6*e-l;e=d*(1-f);var m=d*(1-r*f);f=d*(1-(1-r)*f);switch(l%6){case 0:c=d;b=f;a=e;break;case 1:c=
m;b=d;a=e;break;case 2:c=e;b=d;a=f;break;case 3:c=e;b=m;a=d;break;case 4:c=f;b=e;a=d;break;case 5:c=d,b=e,a=m}return{r:255*c,g:255*b,b:255*a}};g.hex2rgb=function(e){if("string"!==typeof e)return null;e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(f,d,c,b){return d+d+c+c+b+b});return(e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e))?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null};g.rgb2hex=function(e,f,d){function c(b){b=b.toString(16);return 1===b.length?"0"+b:b}
return"#"+c(e)+c(f)+c(d)};g.int2hex=function(e){e=Math.floor(e);e=e.toString(16);if(6>e.length)for(var f=6-e.length;f;)e="0"+e,--f;return"#"+e};return g}()})(window);
(function(h){h.Sankaku.List=function(){function g(){throw Error("List can't create instance");}var e=Math.random,f=Math.floor,d=Math.max;g.word=function(c,b){var a=[],l;for(l=0;l<c;l++)a[l]=b;return a};g.zero=function(c){return this.word(c,0)};g.shuffle=function(c){for(var b=[],a=c.length,l;a;)l=f(e()*c.length),l in c&&(b.push(c[l]),delete c[l],--a);return b};g.max=function(c){return d.apply(null,c)};return g}()})(window);
(function(h){h.Sankaku.Num=function(){function g(){throw Error("Num can't create instance");}var e=h.parseFloat,f=Math.random,d=Math.floor;g.ONE_DEG=Math.PI/180;g.is=function(c){return!isNaN(e(c))&&isFinite(c)};g.random=function(c,b){g.is(b)||(b=c,c=0);return c+d(f()*(b-c+1))};g.deg2rad=function(c){return c*g.ONE_DEG};return g}()})(window);
(function(h){h.Sankaku.Distribute=function(){function g(){throw Error("Distribute can't create instance");}var e=Math.sqrt,f=Math.sin,d=Math.cos,c=Math.random,b=2*Math.PI;g.circle=function(a,l,r){var m;a*=e(c());m=c()*b;return{x:0.5*l+d(m)*a,y:0.5*r+f(m)*a}};return g}()})(window);
(function(h){var g=Math.abs,e=Math.min,f=Math.max,d=Math.round;h.Sankaku.Triangle=function(){function c(a,b,c){this.a=a;this.b=b;this.c=c;var d=b.x-a.x,k=b.y-a.y,n=c.x-a.x,h=c.y-a.y,p=d*(a.x+b.x)+k*(a.y+b.y),q=n*(a.x+c.x)+h*(a.y+c.y),s=2*(d*(c.y-b.y)-k*(c.x-b.x));1E-6>g(s)?(n=e(a.x,b.x,c.x),p=e(a.y,b.y,c.y),d=0.5*(f(a.x,b.x,c.x)-n),a=0.5*(f(a.y,b.y,c.y)-p),this.x=n+d,this.y=p+a):(b=(h*p-k*q)/s,c=(d*q-n*p)/s,d=b-a.x,a=c-a.y,this.x=b,this.y=c);this.r=d*d+a*a}var b=c.prototype;b.constructor=c;b.draw=
function(a){var b=this.a,c=this.b,d=this.c;a.beginPath();a.moveTo(b.x,b.y);a.lineTo(c.x,c.y);a.lineTo(d.x,d.y);a.closePath()};b.centroid=function(){return{x:d((this.a.x+this.b.x+this.c.x)/3),y:d((this.a.y+this.b.y+this.c.y)/3)}};return c}()})(window);
(function(h){h=h.Sankaku;var g=h.Triangle;h.Delaunay=function(){function e(){throw Error("Sankaku can't create instance.");}e.triangulate=function(f){if(3>f.length)return[];var d,c,b,a,l,e,m,k,n,h=function(a){var b=a.length,c,n,d,e,l;a:for(;b;)for(n=a[--b],c=a[--b],d=b;d;)if(l=a[--d],e=a[--d],c===e&&n===l||c===l&&n===e){a.splice(b,2);a.splice(d,2);b-=2;continue a}};f.sort(function(a,b){return b.x-a.x});c=f.length-1;d=f[c];b=d.x;a=f[0].x;for(e=l=d.y;c--;)d.y<l&&(l=d.y),d.y>e&&(e=d.y);m=a-b;k=e-l;c=
m>k?m:k;d=0.5*(a+b);m=0.5*(e+l);e=[new g({x:d-20*c,y:m-c,__sentinel:!0},{x:d,y:m+20*c,__sentinel:!0},{x:d+20*c,y:m-c,__sentinel:!0})];l=[];b=[];for(c=f.length;c--;){b.length=0;a=e.length;for(d=f[c];a--;)n=e[a],m=d.x-n.x,0<m&&m*m>n.r?(l.push(n),e.splice(a,1)):(k=d.y-n.y,m*m+k*k>n.r||(b.push(n.a,n.b,n.b,n.c,n.c,n.a),e.splice(a,1)));h(b);for(a=b.length;a;)k=b[--a],m=b[--a],e.push(new g(m,k,d))}Array.prototype.push.apply(l,e);for(c=l.length;c--;)f=l[c],(f.a.__sentinel||f.b.__sentinel||f.c.__sentinel)&&
l.splice(c,1);return l};return e}()})(window);
(function(h){h.Sankaku.Vector2D=function(){function g(a,b){this.x=a||0;this.y=b||0}var e=Math.floor,f=Math.ceil,d=Math.round,c=Math.cos,b=Math.sin,a=Math.atan2,l=Math.sqrt,r=Math.min,m=Math.acos,k=g.prototype;k.constructor=g;k.draw=function(a){a.beginPath();a.moveTo(0,0);a.lineTo(this.x,this.y);a.closePath();return this};k.clone=function(){return new g(this.x,this.y)};k.zero=function(){this.y=this.x=0;return this};k.isZero=function(){return 0===this.x&&0===this.y};k.set=function(a,b){this.x=a;this.y=
b;return this};k.setX=function(a){this.x=a;return this};k.setY=function(a){this.y=a;return this};k.copy=function(a){this.x=a.x;this.y=a.y;return this};k.add=function(a){this.x+=a.x;this.y+=a.y;return this};k.addScalar=function(a){this.x+=a;this.y+=a;return this};k.addNew=function(a){return new g(this.x+a.x,this.y+a.y)};k.addVector=function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;return this};k.sub=function(a){this.x-=a.x;this.y-=a.y;return this};k.subNew=function(a){return new g(this.x-a.x,this.y-a.y)};
k.subVector=function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;return this};k.multiply=function(a){this.x*=a.x;this.y*=a.y;return this};k.multiplyScalar=function(a){this.x*=a;this.y*=a;return this};k.multiplyNew=function(a){return new g(this.x*a.x,this.y*a.y)};k.divide=function(a){this.x/=a.x;this.y/=a.y;return this};k.divideScalar=function(a){0!==a?(a=1/a,this.x*=a,this.y*=a):this.y=this.x=0;return this};k.divideNew=function(a){return new g(this.x/a.x,this.y/a.y)};k.min=function(a){this.x>a.x&&(this.x=
a.x);this.y>a.y&&(this.y=a.y);return this};k.max=function(a){this.x<a.x&&(this.x=a.x);this.y<a.y&&(this.y=a.y);return this};k.clamp=function(a,b){this.min(a);this.max(b);return this};k.clampScalar=function(a,b){var c,d;c=new g;d=new g;c.set(a,a);d.set(b,b);return this.clamp(c,d)};k.floor=function(){this.x=e(this.x);this.y=e(this.y);return this};k.ceil=function(){this.x=f(this.x);this.y=f(this.y);return this};k.round=function(){this.x=d(this.x);this.y=d(this.y);return this};k.roundToZero=function(){this.x=
0>this.x?f(this.x):e(this.x);this.y=0>this.y?f(this.y):e(this.y);return this};k.negate=function(){return this.multiplyScalar(-1)};k.dot=function(a){return this.x*a.x+this.y*a.y};k.lengthSq=function(){return this.x*this.x+this.y*this.y};k.length=function(){return l(this.lengthSq())};k.setLength=function(a){var b=this.length();0!==b&&a!==b&&this.multiplyScalar(a/b);return this};k.setAngle=function(a){var d=this.length(),d=d||0.001;this.x=c(a)*d;this.y=b(a)*d;return this};k.angle=function(){return a(this.y,
this.x)};k.normalize=function(){return this.divideScalar(this.length())};k.distanceSq=function(a){var b=this.x-a.x;a=this.y-a.y;return b*b+a*a};k.distance=function(a){return l(this.distanceSq(a))};k.lerp=function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;return this};k.equals=function(a){return a.x===this.x&&a.y===this.y};k.fomArray=function(a){this.x=a[0];this.y=a[1];return this};k.toArray=function(){return[this.x,this.y]};k.truncate=function(a){a=r(a,this.length());return this.setLength(a)};
k.reverse=function(){this.negate();return this};k.isNormalize=function(){return 1===this.length()};k.prev=function(){return new g(-this.y,this.x)};k.sign=function(a){return 0>this.prev().dot(a)?-1:1};g.angleBetween=function(a,b){a.isNormalize()||(a=a.clone().normalize());b.isNormalize()||(b=b.clone().normalize());return m(a.dot(b))};return g}()})(window);
(function(h){h=h.Sankaku;var g=h.Vector2D,e=h.Num;h.Object2D=function(){function f(){this._position=new g;this.rotation=this.y=this.x=0;this.width=20;this.height=10}var d=Math.cos,c=Math.sin,b=f.prototype;b.constructor=f;b.position=function(a){this._position=a;this.x=a.x;this.y=a.y};b.getPosition=function(){return this._position};b.setX=function(a){this.x=a;this._position.x=a};b.setY=function(a){this.y=a;this._position.y=a};b.bounding=function(){var a=this.x,b=this.y,e=0.5*this.width,f=0.5*this.height,
k=this.rotation,g,h,p,q,s,t;p=c(k);q=d(k);g=-e;h=-f;k=q*g;s=q*h;h*=p;g*=p;t=q*e;q*=f;e*=p;f*=p;return{a:{x:k-h+a,y:s+g+b},b:{x:t-h+a,y:s+e+b},c:{x:t-f+a,y:q+e+b},d:{x:k-f+a,y:q+g+b}}};b.rotate=function(a){this.rotation=e.deg2rad(a)};b.clone=function(){return this._clone()};b._clone=function(){var a=new f;a.position(this._position.clone());a.width=this.width;a.height=this.height;a.rotation=this.rotation;return a};b.draw=function(a){};return f}()})(window);
(function(h){var g=h.Sankaku,e=g.Object2D,f=g.Vector2D,d=g.Num;g.Shape=function(){function c(a,b,c,f,g,h){e.call(this);this.setX(a);this.setY(b);d.is(c)&&(this.width=c);d.is(f)&&(this.height=f);this._color=g||"#000000";this._fill=!!h;this._line=1;this.border={width:0,color:"#000000"}}g.extend(e,c);var b=c.prototype;b.constructor=c;b.getRadius=function(){var a=this.bounding(),b=a.a,a=a.c;return(new f(b.x,b.y)).distance(a)};b.clone=function(){var a=this._clone();a._color=this._color;a._fill=this._fill;
a._line=this._line;a._border=Object.create(this._border);return a};b.mode=function(a){this._fill=!!a};b.getMode=function(){return this._fill};b.line=function(a){this._line=a};b.getLine=function(){return this._line};b.draw=function(a){var b=this.border;this._fill?(this.fill(a,this._color),0<b.width&&this.stroke(a,b.width,b.color)):this.stroke(a,this._line,this._color)};b.fill=function(a,b){a.fillStyle=b;this.paint(a);a.fill()};b.stroke=function(a,b,c){a.lineWidth=b;a.strokeStyle=c;this.paint(a);a.stroke()};
b.paint=function(a){var b=this.bounding(),c=b.a,d=b.b,e=b.c,b=b.d;a.beginPath();a.moveTo(c.x,c.y);a.lineTo(d.x,d.y);a.lineTo(e.x,e.y);a.lineTo(b.x,b.y);a.lineTo(c.x,c.y);a.closePath()};return c}()})(window);
(function(h){var g=h.Sankaku,e=g.Shape;g.Circle=function(){function f(b,a,c,d,f){e.call(this,b,a,c,c,d,f);this._radius=c||this.width}var d=2*Math.PI;g.extend(e,f);var c=f.prototype;c.constructor=f;c.getRadius=function(){return this._radius};c.clone=function(){return new f(this.x,this.y,this._radius,this._color,this._fill)};c.paint=function(b){b.beginPath();b.arc(this.x,this.y,this._radius,0,d,!1);b.closePath()};return f}()})(window);
(function(h){var g=h.Sankaku,e=g.Vector2D,f=g.Object2D;g.Vehicle=function(){function d(){f.call(this);this._velocity=new e;this._mass=1;this._speed=10;this._behavior=d.BOUNCE;this.bottom=this.right=this.top=this.left=0}var c=Math.abs;g.extend(f,d);d.WRAP="vehicle_wrap";d.BOUNCE="vehicle_bounce";var b=d.prototype;b.constructor=d;b.clone=function(){var a=this._clone();a._velocity=this._velocity.clone();a._mass=this._mass;a._speed=this._speed;a._behavior=this._behavior;return a};b.padding=function(a,
b,c,d){this.top=a;this.right=b||a;this.bottom=c||a;this.left=d||a};b.mass=function(a){this._mass=a};b.getMass=function(){return this._mass};b.speed=function(a){this._speed=a};b.getSpeed=function(){return this._speed};b.behavior=function(a){this._behavior=a};b.getBehavior=function(){return this._behavior};b.velocity=function(a){this._velocity=a};b.getVelocity=function(){return this._velocity};b.draw=function(a){var b=this.bounding(),c,d,e;c=b.a;d=b.b;e=b.c;b=b.d;a.beginPath();a.moveTo(c.x,c.y);a.lineTo(d.x,
d.y+0.5*(e.y-d.y));a.lineTo(b.x,b.y);a.lineTo(c.x,c.y);a.closePath()};b.update=function(a,b){this._update(a,b)};b._update=function(a,b){var e=this._velocity,f=this._position;a-=this.right;b-=this.bottom;e.truncate(c(this._speed));f.add(e);switch(this._behavior){case d.WRAP:this.wrap(a,b);break;default:this.bounce(a,b)}this.x=f.x;this.y=f.y;this.rotation=e.angle()};b.wrap=function(a,b){var c=this._position,d=!1,e=this.left,f=this.top;c.x>a&&(c.x=e,d=!0);c.x<e&&(c.x=a,d=!0);c.y>b&&(c.y=f,d=!0);c.y<
f&&(c.y=b,d=!0);if(d)this.onWrap()};b.onWrap=function(){};b.bounce=function(a,b){var c=this._velocity,d=this._position,e=!1,f=this.left,g=this.top;d.x>a?(d.x=a,c.x*=-1,e=!0):d.x<f&&(d.x=f,c.x*=-1,e=!0);d.y>b?(d.y=b,c.y*=-1,e=!0):d.y<g&&(d.y=g,c.y*=-1,e=!0);if(e)this.onBounce()};b.onBounce=function(){};return d}()})(window);
(function(h){var g=h.Sankaku,e=g.Vehicle,f=g.Vector2D;g.SteeredVehicle=function(){function d(){e.call(this);this._force=new f;this._max=1;this._arrival=100;this._avoid_distance=300;this._buffer=20;this._insight=200;this._close=60}var c=0.5*Math.PI;g.extend(e,d);var b=d.prototype;b.constructor=d;b.clone=function(){var a=this._clone();a._velocity=this._velocity.clone();a._mass=this._mass;a._speed=this._speed;a._behavior=this._behavior;a._force=this._behavior;a._force=this._force.clone();a._max=this._max;
a._arrival=this._arrival;a._avoid_distance=this._avoid_distance;a._buffer=this._buffer;a._insight=this._insight;a._close=this._close;return a};b.getMax=function(){return this._max};b.max=function(a){this._max=a};b.getArrival=function(){return this._arrival};b.arrival=function(a){this._arrival=a};b.force=function(a){this._force=a};b.getForce=function(){return this._force};b.buffer=function(a){this._buffer=a};b.getBuffer=function(){return this._buffer};b.insight=function(a){this._insight=a};b.getInsight=
function(){return this._insight};b.close=function(a){this._close=a};b.getClose=function(){return this._close};b.avoidDistance=function(a){this._avoid_distance=a};b.getAvoidDistance=function(){return this._avoid_distance};b.update=function(a,b){this._force.truncate(this._max).divideScalar(this._mass);this._velocity.add(this._force);this._force=new f;this._update(a,b)};b.seek=function(a){a=a.subNew(this._position);a.normalize().multiplyScalar(this._speed).sub(this._velocity);this._force.add(a)};b.flee=
function(a){a=a.subNew(this._position);a.normalize().multiplyScalar(this._speed).sub(this._velocity);this._force.sub(a)};b.arrive=function(a){var b=a.subNew(this._position),c=this._arrival;b.normalize();a=this._position.distance(a);a>c?b.multiplyScalar(this._speed):b.multiplyScalar(this._speed*a/c);b.sub(this._velocity);this._force.add(b)};b.pursue=function(a){var b=this._position.distance(a.getPosition()),c=a.getPosition().clone();c.add(a._velocity.multiplyNew(b));this.seek(c)};b.evade=function(a){var b=
this._position.distance(a.getPosition())/this._speed,c=a.getPosition().clone();c.sub(a._velocity.multiplyNew(b));this.flee(c)};b.avoid=function(a){var b,d,e,f,g,h,p,q;p=0;for(q=a.length;p<q;p++)b=a[p],d=this._velocity.clone().normalize(),e=b.getPosition().subNew(this._position),f=e.dot(d),0<f&&(g=d.clone(),g.multiplyScalar(this._avoid_distance),h=d.clone(),h.multiplyScalar(f),f=h.subNew(e).length(),f<b.getRadius()+this._buffer&&h.length()<g.length()&&(b=d.clone(),b.multiplyScalar(this._speed),b.setAngle(e.sign(this._velocity)*
c),e=h.length()/g.length(),b.multiplyScalar(1-e),this._force.add(b),this._velocity.multiplyScalar(e)))};return d}()})(window);
(function(h){var g=h.Sankaku,e=g.SteeredVehicle,f=g.Vector2D;g.Wander=function(){function d(){e.call(this);this._angle=0;this._distance=10;this._radius=5;this._range=1;this._range2=0.5*this._range}var c=Math.random;g.extend(e,d);var b=d.prototype;b.constructor=d;b.angle=function(a){this._angle=a};b.getAngle=function(){return this._angle};b.distance=function(a){this._distance=a};b.getDistance=function(){return this._distance};b.radius=function(a){this._radius=a};b.getRadius=function(){return this._radius};
b.range=function(a){this._range=a;this._range2=0.5*a};b.getRange=function(){return this._range};b.wander=function(){var a=this._velocity.clone().normalize().multiplyScalar(this._distance),b=new f;b.setLength(this._radius);b.setAngle(this._angle);this._angle=c()*this._range-this._range2;a.add(b);this._force.add(a)};return d}()})(window);
(function(h){var g=h.Sankaku,e=g.SteeredVehicle,f=g.Vector2D;g.Flock=function(){function d(){e.call(this);this._flock_insight=200;this._flock_close=60}g.extend(e,d);var c=d.prototype;c.constructor=d;c.clone=function(){var b=this._clone();b._velocity=this._velocity.clone();b._mass=this._mass;b._speed=this._speed;b._behavior=this._behavior;b._force=this._behavior;b._force=this._force.clone();b._max=this._max;b._arrival=this._arrival;b._avoid_distance=this._avoid_distance;b._buffer=this._buffer;b._insight=
this._insight;b._close=this._close;b._flock_insight=this._flock_insight;b._flock_close=this._flock_close;return b};c.flockInsight=function(b){this._flock_insight=b};c.getFlockInsight=function(){return this._flock_insight};c.flockClose=function(b){this._flock_close=b};c.getFlockInsight=function(){return this._flock_close};c.flock=function(b){var a=this._velocity.clone(),c=new f,d=0,e,g,h;g=0;for(h=b.length;g<h;g++)e=b[g],e!==this&&this.tooInsight(e)&&(a.add(e.getVelocity()),c.add(e.getPosition()),
this.tooClose(e)&&this.flee(e.getPosition()),++d);0<d&&(a.divideScalar(d),c.divideScalar(d),this.seek(c),this._force.add(a.sub(this._velocity)))};c.tooInsight=function(b){var a;if(this._position.distance(b._position)>this._flock_insight)return!1;a=this._velocity.clone().normalize();return 0>b._position.subNew(this._position).dot(a)};c.tooClose=function(b){return this._position.distance(b._position)<this._flock_close};return d}()})(window);
(function(h){var g=h.Sankaku,e=g.SteeredVehicle;g.FollowPath=function(){function f(){e.call(this);this._index=0;this._threshold=20}g.extend(e,f);var d=f.prototype;d.constructor=g.FollowPath;d.follow=function(c,b){b=!!b;var a=c[this._index];a&&(this._position.distance(a)<this._threshold&&(this._index>=c.length-1?b&&(this._index=0):this._index++),this._index>c.length-1&&!b?this.arrive(a):this.seek(a))};return f}()})(window);
