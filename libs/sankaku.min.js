/*
 inazumatv.com
 @author (at)taikiken / http://inazumatv.com
 @date 2014/06/20 - 11:55

 Copyright (c) 2011-2014 inazumatv.com, inc.

 Distributed under the terms of the MIT license.
 http://www.opensource.org/licenses/mit-license.html

 This notice shall be included in all copies or substantial portions of the Software.

 delaunay
 original: https://github.com/ironwallaby/delaunay

 hosted on
 https://github.com/taikiken/sankaku.js
*/
var Sankaku={version:"0.1.0"};
(function(h){h.console||(h.console={info:function(){},log:function(){},debug:function(){},warn:function(){},error:function(){},table:function(){}});Date.now||(Date.now=function(){return(new Date).getTime()});(function(){for(var f=0,b=["ms","moz","webkit","o"],a=0;a<b.length&&!h.requestAnimationFrame;++a)h.requestAnimationFrame=h[b[a]+"RequestAnimationFrame"],h.cancelAnimationFrame=h[b[a]+"CancelAnimationFrame"]||h[b[a]+"CancelRequestAnimationFrame"];void 0===h.requestAnimationFrame&&void 0!==h.setTimeout&&
(h.requestAnimationFrame=function(a){var b=Date.now(),c=Math.max(0,16-(b-f)),d=h.setTimeout(function(){a(b+c)},c);f=b+c;return d});void 0===h.cancelAnimationFrame&&void 0!==h.clearTimeout&&(h.cancelAnimationFrame=function(a){h.clearTimeout(a)});Object.create||(Object.create=function(){function a(){}return function(b){if(1!==arguments.length)throw Error("Object.create implementation only accepts one parameter.");a.prototype=b;return new a}}());Array.isArray||(Array.isArray=function(a){return"[object Array]"===
Object.prototype.toString.call(a)});Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){var c;c=b?b:0;var d;if(!this)throw new TypeError;d=this.length;if(0===d||c>=d)return-1;for(0>c&&(c=d-Math.abs(c));c<d;c++)if(this[c]===a)return c;return-1});Array.prototype.forEach||(Array.prototype.forEach=function(a,b){var c,d;c=0;for(d=this.length;c<d;++c)c in this&&a.call(b,this[c],c,this)});Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");
var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},k=function(){return c.apply(this instanceof d&&a?this:a,b.concat(Array.prototype.slice.call(arguments)))};d.prototype=this.prototype;k.prototype=new d;return k});String.prototype.trim=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")};navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;window.URL=window.URL||window.webkitURL||window.mozURL||
window.msURL})()})(window.self);(function(h){h.Sankaku.extend=function(f,b){b.prototype=Object.create(f.prototype);b.prototype.constructor=b}})(window);
(function(h){h.Sankaku.Iro=function(){function f(){throw Error("Iro can't create instance");}f.rgb2hsl=function(b,a,e){b/=255;a/=255;e/=255;var g=Math.max(b,a,e),c=Math.min(b,a,e),d,k,m;k=(g+c)/2;if(g===c)d=c=0;else{m=g-c;c=0.5<k?m/(2-g-c):m/(g+c);switch(g){case b:d=(a-e)/m+(a<e?6:0);break;case a:d=(e-b)/m+2;break;case e:d=(b-a)/m+4}d/=6}return{h:d,s:c,l:k}};f.hsl2rgb=function(b,a,e){function g(d,a,c){0>c&&(c+=1);1<c&&(c-=1);return c<1/6?d+6*(a-d)*c:0.5>c?a:c<2/3?d+(a-d)*(2/3-c)*6:d}if(0===a)e=a=
b=e;else{var c=0.5>e?e*(1+a):e+a-e*a,d=2*e-c;e=g(d,c,b+1/3);a=g(d,c,b);b=g(d,c,b-1/3)}return{r:255*e,g:255*a,b:255*b}};f.rgb2hsv=function(b,a,e){b/=255;a/=255;e/=255;var g=Math.max(b,a,e),c=Math.min(b,a,e),d,k=g-c;if(g===c)d=0;else{switch(g){case b:d=(a-e)/k+(a<e?6:0);break;case a:d=(e-b)/k+2;break;case e:d=(b-a)/k+4}d/=6}return{h:d,s:0===g?0:k/g,v:g}};f.hsv2rgb=function(b,a,e){var g,c,d,k=Math.floor(6*b),m=6*b-k;b=e*(1-a);var l=e*(1-m*a);a=e*(1-(1-m)*a);switch(k%6){case 0:g=e;c=a;d=b;break;case 1:g=
l;c=e;d=b;break;case 2:g=b;c=e;d=a;break;case 3:g=b;c=l;d=e;break;case 4:g=a;c=b;d=e;break;case 5:g=e,c=b,d=l}return{r:255*g,g:255*c,b:255*d}};f.hex2rgb=function(b){if("string"!==typeof b)return null;b=b.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(a,b,g,c){return b+b+g+g+c+c});return(b=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b))?{r:parseInt(b[1],16),g:parseInt(b[2],16),b:parseInt(b[3],16)}:null};f.rgb2hex=function(b,a,e){function g(a){a=a.toString(16);return 1===a.length?"0"+a:a}
return"#"+g(b)+g(a)+g(e)};f.int2hex=function(b){b=Math.floor(b);b=b.toString(16);if(6>b.length)for(var a=6-b.length;a;)b="0"+b,--a;return"#"+b};return f}()})(window);
(function(h){h.Sankaku.List=function(){function f(){throw Error("List can't create instance");}var b=Math.random,a=Math.floor,e=Math.max;f.word=function(a,c){var d=[],b;for(b=0;b<a;b++)d[b]=c;return d};f.zero=function(a){return this.word(a,0)};f.shuffle=function(e){for(var c=[],d=e.length,k;d;)k=a(b()*e.length),k in e&&(c.push(e[k]),delete e[k],--d);return c};f.max=function(a){return e.apply(null,a)};return f}()})(window);
(function(h){h.Sankaku.Num=function(){function f(){throw Error("Num can't create instance");}var b=h.parseFloat,a=Math.random,e=Math.floor;f.ONE_DEG=Math.PI/180;f.is=function(a){return!isNaN(b(a))&&isFinite(a)};f.random=function(b,c){f.is(c)||(c=b,b=0);return b+e(a()*(c-b+1))};f.deg2rad=function(a){return a*f.ONE_DEG};return f}()})(window);
(function(h){h.Sankaku.Distribute=function(){function f(){throw Error("Distribute can't create instance");}var b=Math.sqrt,a=Math.sin,e=Math.cos,g=Math.random,c=2*Math.PI;f.circle=function(d,k,m){var l;d*=b(g());l=g()*c;return{x:0.5*k+e(l)*d,y:0.5*m+a(l)*d}};return f}()})(window);
(function(h){var f=Math.abs,b=Math.min,a=Math.max,e=Math.round;h.Sankaku.Triangle=function(){function g(d,c,e){this.a=d;this.b=c;this.c=e;var l=c.x-d.x,g=c.y-d.y,h=e.x-d.x,n=e.y-d.y,p=l*(d.x+c.x)+g*(d.y+c.y),r=h*(d.x+e.x)+n*(d.y+e.y),s=2*(l*(e.y-c.y)-g*(e.x-c.x));1E-6>f(s)?(h=b(d.x,c.x,e.x),p=b(d.y,c.y,e.y),l=0.5*(a(d.x,c.x,e.x)-h),d=0.5*(a(d.y,c.y,e.y)-p),this.x=h+l,this.y=p+d):(c=(n*p-g*r)/s,e=(l*r-h*p)/s,l=c-d.x,d=e-d.y,this.x=c,this.y=e);this.r=l*l+d*d}var c=g.prototype;c.draw=function(d){var a=
this.a,c=this.b,b=this.c;d.beginPath();d.moveTo(a.x,a.y);d.lineTo(c.x,c.y);d.lineTo(b.x,b.y);d.closePath()};c.centroid=function(){return{x:e((this.a.x+this.b.x+this.c.x)/3),y:e((this.a.y+this.b.y+this.c.y)/3)}};return g}()})(window);
(function(h){h=h.Sankaku;var f=h.Triangle;h.Delaunay=function(){function b(){throw Error("Sankaku can't create instance.");}b.triangulate=function(a){if(3>a.length)return[];var b,g,c,d,k,m,l,h,q,n=function(d){var a=d.length,c,b,e,k,m;a:for(;a;)for(b=d[--a],c=d[--a],e=a;e;)if(m=d[--e],k=d[--e],c===k&&b===m||c===m&&b===k){d.splice(a,2);d.splice(e,2);a-=2;continue a}};a.sort(function(d,a){return a.x-d.x});g=a.length-1;b=a[g];c=b.x;d=a[0].x;for(m=k=b.y;g--;)b.y<k&&(k=b.y),b.y>m&&(m=b.y);l=d-c;h=m-k;g=
l>h?l:h;b=0.5*(d+c);l=0.5*(m+k);m=[new f({x:b-20*g,y:l-g,__sentinel:!0},{x:b,y:l+20*g,__sentinel:!0},{x:b+20*g,y:l-g,__sentinel:!0})];k=[];c=[];for(g=a.length;g--;){c.length=0;d=m.length;for(b=a[g];d--;)q=m[d],l=b.x-q.x,0<l&&l*l>q.r?(k.push(q),m.splice(d,1)):(h=b.y-q.y,l*l+h*h>q.r||(c.push(q.a,q.b,q.b,q.c,q.c,q.a),m.splice(d,1)));n(c);for(d=c.length;d;)h=c[--d],l=c[--d],m.push(new f(l,h,b))}Array.prototype.push.apply(k,m);for(g=k.length;g--;)a=k[g],(a.a.__sentinel||a.b.__sentinel||a.c.__sentinel)&&
k.splice(g,1);return k};return b}()})(window);
(function(h){h.Sankaku.Vector2D=function(){function f(a,b){this.x=a||0;this.y=b||0}var b=f.prototype;b.draw=function(a){a.beginPath();a.moveTo(0,0);a.lineTo(this.x,this.y);a.closePath();return this};b.clone=function(){return new f(this.x,this.y)};b.zero=function(){this.y=this.x=0;return this};b.isZero=function(){return 0===this.x&&0===this.y};b.set=function(a,b){this.x=a;this.y=b;return this};b.setX=function(a){this.x=a;return this};b.setY=function(a){this.y=a;return this};b.copy=function(a){this.x=
a.x;this.y=a.y;return this};b.add=function(a){this.x+=a.x;this.y+=a.y;return this};b.addScalar=function(a){this.x+=a;this.y+=a;return this};b.addNew=function(a){return new f(this.x+a.x,this.y+a.y)};b.addVector=function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;return this};b.sub=function(a){this.x-=a.x;this.y-=a.y;return this};b.subNew=function(a){return new f(this.x-a.x,this.y-a.y)};b.subVector=function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;return this};b.multiply=function(a){this.x*=a.x;this.y*=a.y;return this};
b.multiplyScalar=function(a){this.x*=a;this.y*=a;return this};b.multiplyNew=function(a){return new f(this.x*a.x,this.y*a.y)};b.divide=function(a){this.x/=a.x;this.y/=a.y;return this};b.divideScalar=function(a){0!==a?(a=1/a,this.x*=a,this.y*=a):this.y=this.x=0;return this};b.divideNew=function(a){return new f(this.x/a.x,this.y/a.y)};b.min=function(a){this.x>a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);return this};b.max=function(a){this.x<a.x&&(this.x=a.x);this.y<a.y&&(this.y=a.y);return this};b.clamp=
function(a,b){this.min(a);this.max(b);return this};b.clampScalar=function(a,b){var g,c;g=new f;c=new f;g.set(a,a);c.set(b,b);return this.clamp(g,c)};b.floor=function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this};b.ceil=function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this};b.round=function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this};b.roundToZero=function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):
Math.floor(this.y);return this};b.negate=function(){return this.multiplyScalar(-1)};b.dot=function(a){return this.x*a.x+this.y*a.y};b.lengthSq=function(){return this.x*this.x+this.y*this.y};b.length=function(){return Math.sqrt(this.lengthSq())};b.setLength=function(a){var b=this.length();0!==b&&a!==b&&this.multiplyScalar(a/b);return this};b.setAngle=function(a){var b=this.length(),b=b||0.001;this.x=Math.cos(a)*b;this.y=Math.sin(a)*b;return this};b.angle=function(){return Math.atan2(this.y,this.x)};
b.normalize=function(){return this.divideScalar(this.length())};b.distanceSq=function(a){var b=this.x-a.x;a=this.y-a.y;return b*b+a*a};b.distance=function(a){return Math.sqrt(this.distanceSq(a))};b.lerp=function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;return this};b.equals=function(a){return a.x===this.x&&a.y===this.y};b.fomArray=function(a){this.x=a[0];this.y=a[1];return this};b.toArray=function(){return[this.x,this.y]};b.truncate=function(a){a=Math.min(a,this.length());return this.setLength(a)};
b.reverse=function(){this.negate();return this};b.isNormalize=function(){return 1===this.length()};b.prev=function(){return new f(-this.y,this.x)};b.sign=function(a){return 0>this.prev().dot(a)?-1:1};f.angleBetween=function(a,b){a.isNormalize()||(a=a.clone().normalize());b.isNormalize()||(b=b.clone().normalize());return Math.acos(a.dot(b))};return f}()})(window);
(function(h){h=h.Sankaku;var f=h.Vector2D,b=h.Num;h.Object2D=function(){function a(){this._position=new f;this.rotation=this.y=this.x=0;this.width=20;this.height=10}var e=Math.cos,g=Math.sin,c=a.prototype;c.position=function(d){this._position=d;this.x=d.x;this.y=d.y};c.getPosition=function(){return this._position};c.setX=function(d){this.x=d;this._position.x=d};c.setY=function(d){this.y=d;this._position.y=d};c.bounding=function(){var d=this.x,a=this.y,b=0.5*this.width,c=0.5*this.height,f=this.rotation,
h,n,p,r,s,t;p=g(f);r=e(f);h=-b;n=-c;f=r*h;s=r*n;n*=p;h*=p;t=r*b;r*=c;b*=p;c*=p;return{a:{x:f-n+d,y:s+h+a},b:{x:t-n+d,y:s+b+a},c:{x:t-c+d,y:r+b+a},d:{x:f-c+d,y:r+h+a}}};c.rotate=function(d){this.rotation=b.deg2rad(d)};c.clone=function(){return this._clone()};c._clone=function(){var d=new a;d.position(this._position.clone());d.width=this.width;d.height=this.height;d.rotation=this.rotation;return d};c.draw=function(d){};return a}()})(window);
(function(h){var f=h.Sankaku,b=f.Object2D,a=f.Vector2D,e=f.Num;f.Shape=function(){function g(d,a,c,g,f,h){b.call(this);this.setX(d);this.setY(a);e.is(c)&&(this.width=c);e.is(g)&&(this.height=g);this._color=f||"#000000";this._fill=!!h;this._line=1;this.border={width:0,color:"#000000"}}f.extend(b,g);var c=g.prototype;c.getRadius=function(){var d=this.bounding(),b=d.a,d=d.c;return(new a(b.x,b.y)).distance(d)};c.clone=function(){var d=this._clone();d._color=this._color;d._fill=this._fill;d._line=this._line;
d._border=Object.create(this._border);return d};c.mode=function(d){this._fill=!!d};c.getMode=function(){return this._fill};c.line=function(d){this._line=d};c.getLine=function(){return this._line};c.draw=function(d){var a=this.border;this._fill?(this.fill(d,this._color),0<a.width&&this.stroke(d,a.width,a.color)):this.stroke(d,this._line,this._color)};c.fill=function(d,a){d.fillStyle=a;this.paint(d);d.fill()};c.stroke=function(d,a,b){d.lineWidth=a;d.strokeStyle=b;this.paint(d);d.stroke()};c.paint=function(d){var a=
this.bounding(),b=a.a,c=a.b,e=a.c,a=a.d;d.beginPath();d.moveTo(b.x,b.y);d.lineTo(c.x,c.y);d.lineTo(e.x,e.y);d.lineTo(a.x,a.y);d.lineTo(b.x,b.y);d.closePath()};return g}()})(window);
(function(h){var f=h.Sankaku,b=f.Shape;f.Circle=function(){function a(a,d,e,g,f){b.call(this,a,d,e,e,g,f);this._radius=e||this.width}var e=2*Math.PI;f.extend(b,a);var g=a.prototype;g.getRadius=function(){return this._radius};g.clone=function(){return new a(this.x,this.y,this._radius,this._color,this._fill)};g.paint=function(a){a.beginPath();a.arc(this.x,this.y,this._radius,0,e,!1);a.closePath()};return a}()})(window);
(function(h){var f=h.Sankaku,b=f.Vector2D,a=f.Object2D;f.Vehicle=function(){function e(){a.call(this);this._velocity=new b;this._mass=1;this._speed=10;this._behavior=e.BOUNCE;this.bottom=this.right=this.top=this.left=0}var g=Math.abs;f.extend(a,e);e.WRAP="vehicle_wrap";e.BOUNCE="vehicle_bounce";var c=e.prototype;c.clone=function(){var d=this._clone();d._velocity=this._velocity.clone();d._mass=this._mass;d._speed=this._speed;d._behavior=this._behavior;return d};c.padding=function(d,a,b,c){this.top=
d;this.right=a||d;this.bottom=b||d;this.left=c||d};c.mass=function(d){this._mass=d};c.getMass=function(){return this._mass};c.speed=function(d){this._speed=d};c.getSpeed=function(){return this._speed};c.behavior=function(d){this._behavior=d};c.getBehavior=function(){return this._behavior};c.velocity=function(d){this._velocity=d};c.getVelocity=function(){return this._velocity};c.draw=function(d){var a=this.bounding(),b,c,e;b=a.a;c=a.b;e=a.c;a=a.d;d.beginPath();d.moveTo(b.x,b.y);d.lineTo(c.x,c.y+0.5*
(e.y-c.y));d.lineTo(a.x,a.y);d.lineTo(b.x,b.y);d.closePath()};c.update=function(d,a){this._update(d,a)};c._update=function(a,b){var c=this._velocity,f=this._position;a-=this.right;b-=this.bottom;c.truncate(g(this._speed));f.add(c);switch(this._behavior){case e.WRAP:this.wrap(a,b);break;default:this.bounce(a,b)}this.x=f.x;this.y=f.y;this.rotation=c.angle()};c.wrap=function(a,b){var c=this._position,e=!1,f=this.left,g=this.top;c.x>a&&(c.x=f,e=!0);c.x<f&&(c.x=a,e=!0);c.y>b&&(c.y=g,e=!0);c.y<g&&(c.y=
b,e=!0);if(e)this.onWrap()};c.onWrap=function(){};c.bounce=function(a,b){var c=this._velocity,e=this._position,f=!1,g=this.left,h=this.top;e.x>a?(e.x=a,c.x*=-1,f=!0):e.x<g&&(e.x=g,c.x*=-1,f=!0);e.y>b?(e.y=b,c.y*=-1,f=!0):e.y<h&&(e.y=h,c.y*=-1,f=!0);if(f)this.onBounce()};c.onBounce=function(){};return e}()})(window);
(function(h){var f=h.Sankaku,b=f.Vehicle,a=f.Vector2D;f.SteeredVehicle=function(){function e(){b.call(this);this._force=new a;this._max=1;this._arrival=100;this._avoid_distance=300;this._buffer=20;this._insight=200;this._close=60}var g=0.5*Math.PI;f.extend(b,e);var c=e.prototype;c.clone=function(){var a=this._clone();a._velocity=this._velocity.clone();a._mass=this._mass;a._speed=this._speed;a._behavior=this._behavior;a._force=this._behavior;a._force=this._force.clone();a._max=this._max;a._arrival=
this._arrival;a._avoid_distance=this._avoid_distance;a._buffer=this._buffer;a._insight=this._insight;a._close=this._close;return a};c.getMax=function(){return this._max};c.max=function(a){this._max=a};c.getArrival=function(){return this._arrival};c.arrival=function(a){this._arrival=a};c.force=function(a){this._force=a};c.getForce=function(){return this._force};c.buffer=function(a){this._buffer=a};c.getBuffer=function(){return this._buffer};c.insight=function(a){this._insight=a};c.getInsight=function(){return this._insight};
c.close=function(a){this._close=a};c.getClose=function(){return this._close};c.avoidDistance=function(a){this._avoid_distance=a};c.getAvoidDistance=function(){return this._avoid_distance};c.update=function(b,c){this._force.truncate(this._max).divideScalar(this._mass);this._velocity.add(this._force);this._force=new a;this._update(b,c)};c.seek=function(a){a=a.subNew(this._position);a.normalize().multiplyScalar(this._speed).sub(this._velocity);this._force.add(a)};c.flee=function(a){a=a.subNew(this._position);
a.normalize().multiplyScalar(this._speed).sub(this._velocity);this._force.sub(a)};c.arrive=function(a){var b=a.subNew(this._position),c=this._arrival;b.normalize();a=this._position.distance(a);a>c?b.multiplyScalar(this._speed):b.multiplyScalar(this._speed*a/c);b.sub(this._velocity);this._force.add(b)};c.pursue=function(a){var b=this._position.distance(a.getPosition()),c=a.getPosition().clone();c.add(a._velocity.multiplyNew(b));this.seek(c)};c.evade=function(a){var b=this._position.distance(a.getPosition())/
this._speed,c=a.getPosition().clone();c.sub(a._velocity.multiplyNew(b));this.flee(c)};c.avoid=function(a){var b,c,e,f,h,n,p,r;p=0;for(r=a.length;p<r;p++)b=a[p],c=this._velocity.clone().normalize(),e=b.getPosition().subNew(this._position),f=e.dot(c),0<f&&(h=c.clone(),h.multiplyScalar(this._avoid_distance),n=c.clone(),n.multiplyScalar(f),f=n.subNew(e).length(),f<b.getRadius()+this._buffer&&n.length()<h.length()&&(b=c.clone(),b.multiplyScalar(this._speed),b.setAngle(e.sign(this._velocity)*g),e=n.length()/
h.length(),b.multiplyScalar(1-e),this._force.add(b),this._velocity.multiplyScalar(e)))};return e}()})(window);
(function(h){var f=h.Sankaku,b=f.SteeredVehicle,a=f.Vector2D;f.Wander=function(){function e(){b.call(this);this._angle=0;this._distance=10;this._radius=5;this._range=1}var g=Math.random;f.extend(b,e);var c=e.prototype;c.angle=function(a){this._angle=a};c.getAngle=function(){return this._angle};c.distance=function(a){this._distance=a};c.getDistance=function(){return this._distance};c.radius=function(a){this._radius=a};c.getRadius=function(){return this._radius};c.range=function(a){this._range=a};c.getRange=
function(){return this._range};c.wander=function(){var b=this._velocity.clone().normalize().multiplyScalar(this._distance),c=new a;c.setLength(this._radius);c.setAngle(this._angle);this._angle=g()*this._range-0.5*this._range;b.add(c);this._force.add(b)};return e}()})(window);
(function(h){var f=h.Sankaku,b=f.SteeredVehicle,a=f.Vector2D;f.Flock=function(){function e(){b.call(this);this._flock_insight=200;this._flock_close=60}f.extend(b,e);var g=e.prototype;g.clone=function(){var a=this._clone();a._velocity=this._velocity.clone();a._mass=this._mass;a._speed=this._speed;a._behavior=this._behavior;a._force=this._behavior;a._force=this._force.clone();a._max=this._max;a._arrival=this._arrival;a._avoid_distance=this._avoid_distance;a._buffer=this._buffer;a._insight=this._insight;
a._close=this._close;a._flock_insight=this._flock_insight;a._flock_close=this._flock_close;return a};g.flockInsight=function(a){this._flock_insight=a};g.getFlockInsight=function(){return this._flock_insight};g.flockClose=function(a){this._flock_close=a};g.getFlockInsight=function(){return this._flock_close};g.flock=function(b){var d=this._velocity.clone(),e=new a,f=0,g,h,q;h=0;for(q=b.length;h<q;h++)g=b[h],g!==this&&this.tooInsight(g)&&(d.add(g.getVelocity()),e.add(g.getPosition()),this.tooClose(g)&&
this.flee(g.getPosition()),++f);0<f&&(d.divideScalar(f),e.divideScalar(f),this.seek(e),this._force.add(d.sub(this._velocity)))};g.tooInsight=function(a){var b;if(this._position.distance(a._position)>this._flock_insight)return!1;b=this._velocity.clone().normalize();return 0>a._position.subNew(this._position).dot(b)};g.tooClose=function(a){return this._position.distance(a._position)<this._flock_close};return e}()})(window);
